// Émettre les particules avec effet d'ondes de choc
        function emitParticles() {
          console.log('Émission des particules - EFFET ONDE DE CHOC');
          
          // Triple onde de choc concentrique
          if (explosionSphere) {
            explosionSphere.setAttribute('visible', true);
            explosionSphere.setAttribute('material', 'opacity: 0.8; emissive: #ff3300; emissiveIntensity: 4; transparent: true');
            explosionSphere.setAttribute('radius', 5);
            
            // Première onde
            explosionSphere.setAttribute('animation__wave1', {
              property: 'radius',
              from: 5,
              to: 150,
              dur: 1200,
              easing: 'easeOutQuint'
            });
            
            explosionSphere.setAttribute('animation__fade1', {
              property: 'material.opacity',
              from: 0.8,
              to: 0,
              dur: 1200,
              easing: 'easeOutQuad'
            });
            
            // Deuxième onde (retardée)
            setTimeout(() => {
              explosionSphere.setAttribute('radius', 5);
              explosionSphere.setAttribute('material.opacity', 0.6);
              explosionSphere.setAttribute('animation__wave2', {
                property: 'radius',
                from: 5,
                to: 180,
                dur: 1500,
                easing: 'easeOutQuint'
              });
              explosionSphere.setAttribute('animation__fade2', {
                property: 'material.opacity',
                from: 0.6,
                to: 0,
                dur: 1500,
                easing: 'easeOutQuad'
              });
            }, 300);
            
            setTimeout(() => {
              explosionSphere.setAttribute('visible', false);
            }, 1800);
          }
          
          // Particules en spirales avec trajectoires complexes
          particles.forEach((particle, i) => {
            const spiralGroup = i % 3; // 3 groupes de spirales
            const delay = spiralGroup * 150 + (i % 40) * 8;
            
            setTimeout(() => {
              particle.setAttribute('visible', true);
              particle.setAttribute('position', '0 0 0');
              particle.setAttribute('material', 'opacity: 1; transparent: true');
              particle.setAttribute('width', 3);
              particle.setAttribute('height', 3);
              particle.setAttribute('depth', 3);
              
              // Trajectoire en spirale hélicoïdale
              const turns = 2 + Math.random();
              const endAngle = turns * Math.PI * 2;
              const radiusEnd = 90 + Math.random() * 70;
              const heightVariation = (Math.random() - 0.5) * 100;
              
              // Créer plusieurs points pour une trajectoire courbe
              const steps = 6;
              for (let step = 1; step <= steps; step++) {
                const progress = step / steps;
                const currentAngle = (i / particles.length) * Math.PI * 2 + endAngle * progress;
                const currentRadius = radiusEnd * progress;
                const currentHeight = heightVariation * Math.sin(progress * Math.PI);
                
                const x = Math.cos(currentAngle) * currentRadius;
                const y = currentHeight;
                const z = Math.sin(currentAngle) * currentRadius;
                
                particle.setAttribute(`animation__path${step}`, {
                  property: 'position',
                  to: `${x} ${y} ${z}`,
                  dur: 2200 / steps,
                  delay: (step - 1) * (2200 / steps),
                  easing: step === steps ? 'easeOutCubic' : 'linear'
                });
              }
              
              // Rotation rapide et chaotique
              particle.setAttribute('animation__spin', {
                property: 'rotation',
                to: `${360 + Math.random() * 720} ${360 + Math.random() * 720} ${360 + Math.random() * 720}`,
                dur: 2200,
                easing: 'easeOutQuad'
              });
              
              // Rétrécissement progressif
              particle.setAttribute('animation__shrink', {
                property: 'scale',
                from: '1 1 1',
                to: '0.1 0.1 0.1',
                dur: 2200,
                delay: 800,
                easing: 'easeInQuad'
              });
              
              // Fade out avec clignotement
              particle.setAttribute('animation__fade', {
                property: 'material.opacity',
                from: 1,
                to: 0,
                dur: 2200,
                delay: 600,
                easing: 'easeInQuad'
              });
              
              setTimeout(() => {
                particle.setAttribute('visible', false);
                particle.setAttribute('scale', '1 1 1');
              }, 2800);
            }, delay);
          });
        }
